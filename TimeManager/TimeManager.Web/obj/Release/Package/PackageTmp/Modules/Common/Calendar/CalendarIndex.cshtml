@model TimeManager.Common.CalendarPageModel
@{
    ViewData["Title"] = "Calendar";
}

@section Head {
    <style>

        html, body {
            margin: 0;
            padding: 0;
            font-family: Arial, Helvetica Neue, Helvetica, sans-serif;
            font-size: 14px;
        }

        #calendar {
            max-width: 1000px;
            margin: 10px auto;
        }

        /*
        i wish this required CSS was better documented :(
        https://github.com/FezVrasta/popper.js/issues/674
        derived from this CSS on this page: https://popper.js.org/tooltip-examples.html
        */

        .popper,
        .tooltip {
            position: absolute;
            z-index: 9999;
            background: #FFC107;
            color: black;
            width: 150px;
            border-radius: 3px;
            box-shadow: 0 0 2px rgba(0,0,0,0.5);
            padding: 10px;
            text-align: center;
        }

        .style5 .tooltip {
            background: #1E252B;
            color: #FFFFFF;
            max-width: 200px;
            width: auto;
            font-size: .8rem;
            padding: .5em 1em;
        }

        .popper .popper__arrow,
        .tooltip .tooltip-arrow {
            width: 0;
            height: 0;
            border-style: solid;
            position: absolute;
            margin: 5px;
        }

        .tooltip .tooltip-arrow,
        .popper .popper__arrow {
            border-color: #FFC107;
        }

        .style5 .tooltip .tooltip-arrow {
            border-color: #1E252B;
        }

        .popper[x-placement^="top"],
        .tooltip[x-placement^="top"] {
            margin-bottom: 5px;
        }

            .popper[x-placement^="top"] .popper__arrow,
            .tooltip[x-placement^="top"] .tooltip-arrow {
                border-width: 5px 5px 0 5px;
                border-left-color: transparent;
                border-right-color: transparent;
                border-bottom-color: transparent;
                bottom: -5px;
                left: calc(50% - 5px);
                margin-top: 0;
                margin-bottom: 0;
            }

        .popper[x-placement^="bottom"],
        .tooltip[x-placement^="bottom"] {
            margin-top: 5px;
        }

            .tooltip[x-placement^="bottom"] .tooltip-arrow,
            .popper[x-placement^="bottom"] .popper__arrow {
                border-width: 0 5px 5px 5px;
                border-left-color: transparent;
                border-right-color: transparent;
                border-top-color: transparent;
                top: -5px;
                left: calc(50% - 5px);
                margin-top: 0;
                margin-bottom: 0;
            }

        .tooltip[x-placement^="right"],
        .popper[x-placement^="right"] {
            margin-left: 5px;
        }

            .popper[x-placement^="right"] .popper__arrow,
            .tooltip[x-placement^="right"] .tooltip-arrow {
                border-width: 5px 5px 5px 0;
                border-left-color: transparent;
                border-top-color: transparent;
                border-bottom-color: transparent;
                left: -5px;
                top: calc(50% - 5px);
                margin-left: 0;
                margin-right: 0;
            }

        .popper[x-placement^="left"],
        .tooltip[x-placement^="left"] {
            margin-right: 5px;
        }

            .popper[x-placement^="left"] .popper__arrow,
            .tooltip[x-placement^="left"] .tooltip-arrow {
                border-width: 5px 0 5px 5px;
                border-top-color: transparent;
                border-right-color: transparent;
                border-bottom-color: transparent;
                right: -5px;
                top: calc(50% - 5px);
                margin-left: 0;
                margin-right: 0;
            }
    </style>

    <link href='~/Scripts/fullcalendar/fullcalendar4.4.0/core/main.css' rel='stylesheet' />
    <link href='~/Scripts/fullcalendar/fullcalendar4.4.0/core/main.min.css' rel='stylesheet' />
    <link href='~/Scripts/fullcalendar/fullcalendar4.4.0/daygrid/main.css' rel='stylesheet' />
    <link href='~/Scripts/fullcalendar/fullcalendar4.4.0/daygrid/main.min.css' rel='stylesheet' />
    <link href='~/Scripts/fullcalendar/fullcalendar4.4.0/timegrid/main.css' rel='stylesheet' />
    <link href='~/Scripts/fullcalendar/fullcalendar4.4.0/timegrid/main.min.css' rel='stylesheet' />
    <link href='~/Scripts/fullcalendar/fullcalendar4.4.0/list/main.css' rel='stylesheet' />
    <link href='~/Scripts/fullcalendar/fullcalendar4.4.0/list/main.min.css' rel='stylesheet' />

    <script src='~/Scripts/fullcalendar/fullcalendar4.4.0/core/main.js'></script>
    <script src='~/Scripts/fullcalendar/fullcalendar4.4.0/core/main.min.js'></script>

    <script src='~/Scripts/fullcalendar/fullcalendar4.4.0/daygrid/main.js'></script>
    <script src='~/Scripts/fullcalendar/fullcalendar4.4.0/daygrid/main.min.js'></script>

    <script src='~/Scripts/fullcalendar/fullcalendar4.4.0/interaction/main.js'></script>
    <script src='~/Scripts/fullcalendar/fullcalendar4.4.0/interaction/main.min.js'></script>

    <script src='~/Scripts/fullcalendar/fullcalendar4.4.0/timegrid/main.js'></script>
    <script src='~/Scripts/fullcalendar/fullcalendar4.4.0/timegrid/main.min.js'></script>

    <script src='~/Scripts/fullcalendar/fullcalendar4.4.0/list/main.js'></script>
    <script src='~/Scripts/fullcalendar/fullcalendar4.4.0/list/main.min.js'></script>

    <script src='~/Scripts/fullcalendar/fullcalendar4.4.0/core/locales-all.js'></script>
    <script src='~/Scripts/fullcalendar/fullcalendar4.4.0/core/locales-all.min.js'></script>
    <script src="https://unpkg.com/popper.js/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tooltip.js/dist/umd/tooltip.min.js"></script>

    <script type="text/javascript">

        document.addEventListener('DOMContentLoaded', function () {
            var calendarEl = document.getElementById('calendar');

            /* Create function to initialize the correct view */
            function mobileCheck() {
                if (window.innerWidth >= 768) {
                    return false;
                } else {
                    return true;
                }
            };

            var calendar = new FullCalendar.Calendar(calendarEl, {
                //plugins:  [ 'interaction', 'dayGrid', 'timeGrid', 'list' ],
                plugins: ['interaction', 'dayGrid', 'timeGrid', 'list'],

                timeZone: 'Local',
                timeFormat: 'H:mm',
                locale: 'it',

                height: mobileCheck() ? 550 : 800,

                header: {
                    left: mobileCheck() ? 'prev,next' : 'prevYear,prev,next,nextYear',
                    center: mobileCheck() ? '' : 'title',
                    right: mobileCheck() ? 'listWeek,timeGridWeek' : 'dayGridMonth,timeGridWeek,timeGridDay'
                },

                //defaultView: 'dayGridMonth', 'timeGridWeek'
                defaultView: mobileCheck() ? 'listWeek' : 'dayGridMonth',

                // responsive
                //windowResize: function (view) {
                //    if ($(window).width() < 765) {
                //        $('#calendar').fullCalendar('changeView', 'basicDay');
                //    } else {
                //        $('#calendar').fullCalendar('changeView', 'basicWeek');
                //    }
                //},

                events: 'Calendar/LoadEvents/',
                selectable: true,


                //Codice colore attività
                //priorità 1 (ALTA) = ROSSO
                //priorità 2 (MEDIA) = BLU
                //priorità 3 (BASSA) = VERDE
                eventRender: function (event, element, view) {
                    if (event.color) {
                        element.css('background-color', event.color)
                    }
                },

                //apertura campo url
                //eventClick: function (info) {
                //    info.jsEvent.preventDefault(); // don't let the browser navigate
                //    //info.el.style.borderColor = 'red';
                //    if (info.event.url) {
                //        window.open(info.event.url);
                //    }
                //},

                //eventClick: function (info) {
                //    alert('Event: ' + info.event.title);
                //    //alert('Coordinates: ' + info.jsEvent.pageX + ',' + info.jsEvent.pageY);
                //    //alert('View: ' + info.view.type);

                //    // change the border color just for fun
                //    info.el.style.borderColor = 'red';
                //},

                //eventDidMount: function (info) {
                //    var tooltip = new Tooltip(info.el, {
                //        title: info.event.title,
                //        placement: 'top',
                //        trigger: 'hover',
                //        container: 'body'
                //    });
                //},

                //eventTimeFormat: { // like '14:30:00'
                //    hour: '2-digit',
                //    minute: '2-digit',
                //    second: '2-digit',
                //    meridiem: false
                //},

                //events: [
                //    {
                //        "id": "5",
                //        "title": "Manutenzioni ordinarie - impianti elettrici",
                //        start: "2020-03-03",
                //        end: "2020-03-04",
                //        allDay: false
                //    },
                //    {
                //        id: "6",
                //        title: "Manutenzioni ordinarie - Impianto di depurazione acque",
                //        start: "2020-03-30",
                //        end: "2020-03-31",
                //        allDay: false
                //    }]

            });

            //calendar.setOption('locale', 'it');
            //calendar.setOption('height', 550);
            calendar.render();
        });
    </script>
}

@section ContentHeader {
    <h1>@LocalText.Get("Navigation.Calendar")</h1>
}
@*<div class="row">*@
@*<div class="box box-solid">*@

@*<div class="info-box">
        <span class="info-box-icon bg-yellow">
            <i class="ion ion-ios-gear-outline"></i>
            <a href="~/Default/Activities" class="small-box-footer"><i class="fa fa-address-book"></i></a>
        </span>
        <div class="info-box-content">
            <span class="info-box-text">ATTIVITA</span>
            <span class="info-box-number" href="~/Default/Activities"><small> Apri agenda ATTIVITA' </small></span>
        </div><!-- /.info-box-content -->
    </div><!-- /.info-box -->*@

<div class="box box-body">

    <div class="box-body no-padding">
        <!-- THE CALENDAR -->
        <div id="calendar"></div>
        <div id="tooltip" role="tooltip">
            <div id="arrow" data-popper-arrow></div>
        </div>
    </div><!-- /.box-body -->

    <div class="box-footer clearfix">
        @*<a href="javascript::;" class="btn btn-sm btn-info btn-flat pull-left">Place New Order</a>*@
        <a href="~/Default/Activities" class="btn btn-sm btn-default btn-flat pull-right">Vedi ATTIVITA'</a>
        <a href="~/Default/Activities#new" class="btn btn-sm btn-info btn-flat pull-right">Nuova ATTIVITA'</a>
    </div> <!--/.box-footer-->

</div> <!--/. box -->
<!--</div>--><!-- /.col -->
<!--</div>--><!-- /.row -->
